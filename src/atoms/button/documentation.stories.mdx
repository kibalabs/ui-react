import { Meta, Story, Canvas, ArgsTable } from '@storybook/addon-docs/blocks';

import { Button, IButtonProps } from '.';
import { EqualGrid, Stack } from '../../layouts';
import { Direction } from '../../model';
import { Box, PaddingSize, KibaIcon, Text } from '../../particles';
import { MultiLineInput } from '../../molecules';
import { buildTheme, ThemeProvider } from '../../theming';

<Meta
  component={Button}
  title={'Atoms/Button'}
/>

# Button

<br/>

export const Template = (args) => (
  <Button {...args} />
);

<Canvas withToolbar={true} withSource={'none'}>
  <Story name='Default' args={{text: 'Default Button'}}>
    {Template.bind({})}
  </Story>
</Canvas>

<ArgsTable story={'Default'} />

### Examples

<Canvas>
  <Story name='Primary'>
    <Button variant='primary' text='Primary Button'/>
  </Story>
</Canvas>

<Canvas>
  <Story name='Secondary'>
    <Button variant='secondary' text='Secondary Button'/>
  </Story>
</Canvas>

<Canvas>
  <Story name='Right Icon'>
    <Button iconRight={<KibaIcon iconId='ion-aperture' />} text='Button With Right Icon'/>
  </Story>
</Canvas>

<Canvas>
  <Story name='Left Icon'>
    <Button iconLeft={<KibaIcon iconId='ion-aperture' />} text='Button With Left Icon'/>
  </Story>
</Canvas>

<Canvas>
  <Story name='Disabled'>
    <Button isEnabled={false} text='Button Disabled'/>
  </Story>
</Canvas>

### Theming

<Canvas>
  <Story name='testblock'>
    {() => {
      const defaultTheme = React.useMemo(() => buildTheme(), []);
      const [themeData, setThemeData] = React.useState({});
      const [defaultThemeField, setDefaultThemeField] = React.useState(JSON.stringify(defaultTheme.buttons.default.normal.default, undefined, 4));
      const [hoverThemeField, setHoverThemeField] = React.useState(JSON.stringify(defaultTheme.buttons.default.normal.hover, undefined, 4));
      const [focusThemeField, setFocusThemeField] = React.useState(JSON.stringify(defaultTheme.buttons.default.normal.focus, undefined, 4));
      const [pressThemeField, setPressThemeField] = React.useState(JSON.stringify(defaultTheme.buttons.default.normal.press, undefined, 4));
      const [theme, setTheme] = React.useState(buildTheme({
        buttons: {
          default: {
            normal: {
              ...themeData
            }
          }
        },
        inputWrappers: {
          default: {
            normal: {
              default: {
                text: {
                  "font-size": '0.73em',
                }
              }
            }
          }
        }
      }));
      React.useEffect(() => {
        setTheme(buildTheme({
          ...theme,
          buttons: {
          default: {
            normal: {
              ...themeData
            }
          }
        }
        }))
      },
      [themeData]);
      React.useEffect(() => {
        setTimeout(() => {
          const changedValue = JSON.parse(defaultThemeField);
          if(JSON.stringify(changedValue) !== JSON.stringify(defaultTheme.buttons.default.normal.default)){
            setThemeData({ ...themeData, default: changedValue });
          }
        } , 1500);
      },
      [defaultThemeField]);
      React.useEffect(() => {
        setTimeout(() => {
          const changedValue = JSON.parse(hoverThemeField);
          if(JSON.stringify(changedValue) !== JSON.stringify(defaultTheme.buttons.default.normal.hover)){
            setThemeData({ ...themeData, hover: changedValue });
          }
        } , 1500);
      },
      [hoverThemeField]);
      React.useEffect(() => {
        setTimeout(() => {
          const changedValue = JSON.parse(focusThemeField);
          if(JSON.stringify(changedValue) !== JSON.stringify(defaultTheme.buttons.default.normal.focus)){
            setThemeData({ ...themeData, focus: changedValue });
          }
        } , 1500);
      },
      [focusThemeField]);
      React.useEffect(() => {
        setTimeout(() => {
          const changedValue = JSON.parse(pressThemeField);
          if(JSON.stringify(changedValue) !== JSON.stringify(defaultTheme.buttons.default.normal.press)){
            setThemeData({ ...themeData, press: changedValue });
          }
        } , 1500);
      },
      [pressThemeField]);
      return (
        <ThemeProvider theme={theme}>
          <Button text='Themed Button' />
          <EqualGrid childSize={3} >
            <Box maxHeight='250px'>
              <Stack direction={Direction.Vertical} defaultGutter={PaddingSize.Wide} shouldAddGutters={true}>
                <Text>Default</Text>
                <MultiLineInput value={defaultThemeField} onValueChanged={(val) => setDefaultThemeField(val)} />
              </Stack>
            </Box>
            <Box>
              <Stack direction={Direction.Vertical} defaultGutter={PaddingSize.Wide} shouldAddGutters={true}>
                <Text>Hover</Text>
                <MultiLineInput value={hoverThemeField} onValueChanged={(val) => setHoverThemeField(val)} />
              </Stack>
            </Box>
            <Box>
              <Stack direction={Direction.Vertical} defaultGutter={PaddingSize.Wide} shouldAddGutters={true}>
                <Text>Focus</Text>
                <MultiLineInput value={focusThemeField} onValueChanged={(val) => setFocusThemeField(val)} />
              </Stack>
            </Box>
            <Box>
              <Stack direction={Direction.Vertical} defaultGutter={PaddingSize.Wide} shouldAddGutters={true}>
                <Text>Press</Text>
                <MultiLineInput value={pressThemeField} onValueChanged={(val) => setPressThemeField(val)} />
              </Stack>
            </Box>
          </EqualGrid>
        </ThemeProvider>
      );
      }
    }
  </Story>
</Canvas>


TODO
